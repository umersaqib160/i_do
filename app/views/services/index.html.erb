<%= form_tag(controller:"services", action: "index") do %>
  <%= label :service_name, "" %>
  <%= text_field_tag :search_term, params[:search_term] %>

  <%= submit_tag "Search" %>
<% end %>




<% @services.each do |service| %>

  <%= service.name %>
<br>
  <% if service.user %>
     Name: <%= service.user.first_name %>
          <%= service.user.last_name %>
      <br>
     Email: <%= service.user.email %>
      <br>
      Address:  <%= service.user.address%>
      <br>
     Phone Number: <%= service.user.phone %>
      <br>
  <% else %>
      <p>No user found</p>
  <% end %>
<% end %>


<div id="map" style="width: 100%; height: 600px;"></div>
</div>
<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).on('ready', function() {
      handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map' } }, function(){
        markers = handler.addMarkers(<%= raw @markers.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
      });
    })
  <% end %>
<% end %>
